{"ast":null,"code":"import _objectSpread from\"/home/kodachi/Desktop/Frontend1/Frontend1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _taggedTemplateLiteral from\"/home/kodachi/Desktop/Frontend1/Frontend1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7;import React from'react';import styled,{keyframes,css}from'styled-components';import{Box,Button,Flex,HelpIcon,Link,LinkExternal,MetamaskIcon,Skeleton,Text,TimerIcon,useTooltip}from'@pancakeswap/uikit';import{BASE_BSC_SCAN_URL,BASE_URL}from'config';import{getBscScanBlockCountdownUrl}from'utils/bscscan';import{useBlock,useCakeVault}from'state/hooks';import BigNumber from'bignumber.js';import{useTranslation}from'contexts/Localization';import Balance from'components/Balance';import{CompoundingPoolTag,ManualPoolTag}from'components/Tags';import{getAddress,getCakeVaultAddress}from'utils/addressHelpers';import{registerToken}from'utils/wallet';import{getBalanceNumber,getFullDisplayBalance}from'utils/formatBalance';import{getPoolBlockInfo}from'views/Pools/helpers';import Harvest from'./Harvest';import Stake from'./Stake';import Apr from'../Apr';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var expandAnimation=keyframes(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  from {\\n    max-height: 0px;\\n  }\\n  to {\\n    max-height: 700px;\\n  }\\n\"])));var collapseAnimation=keyframes(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  from {\\n    max-height: 700px;\\n  }\\n  to {\\n    max-height: 0px;\\n  }\\n\"])));var StyledActionPanel=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  animation: \",\";\\n  overflow: hidden;\\n  background: \",\";\\n  display: flex;\\n  flex-direction: column-reverse;\\n  justify-content: center;\\n  padding: 12px;\\n\\n  \",\" {\\n    flex-direction: row;\\n    padding: 16px 32px;\\n  }\\n\"])),function(_ref){var expanded=_ref.expanded;return expanded?css(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n          \",\" 300ms linear forwards\\n        \"])),expandAnimation):css(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n          \",\" 300ms linear forwards\\n        \"])),collapseAnimation);},function(_ref2){var theme=_ref2.theme;return theme.colors.dropdown;},function(_ref3){var theme=_ref3.theme;return theme.mediaQueries.lg;});var ActionContainer=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n\\n  \",\" {\\n    flex-direction: row;\\n    align-items: center;\\n    flex-grow: 1;\\n    flex-basis: 0;\\n  }\\n\"])),function(_ref4){var theme=_ref4.theme;return theme.mediaQueries.sm;});var InfoSection=styled(Box)(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  flex-grow: 0;\\n  flex-shrink: 0;\\n  flex-basis: auto;\\n  padding: 8px 8px;\\n  \",\" {\\n    padding: 0;\\n    flex-basis: 230px;\\n  }\\n\"])),function(_ref5){var theme=_ref5.theme;return theme.mediaQueries.lg;});var ActionPanel=function ActionPanel(_ref6){var _window$ethereum;var account=_ref6.account,pool=_ref6.pool,userDataLoaded=_ref6.userDataLoaded,expanded=_ref6.expanded,breakpoints=_ref6.breakpoints;var sousId=pool.sousId,stakingToken=pool.stakingToken,earningToken=pool.earningToken,totalStaked=pool.totalStaked,startBlock=pool.startBlock,endBlock=pool.endBlock,stakingLimit=pool.stakingLimit,contractAddress=pool.contractAddress,isAutoVault=pool.isAutoVault;var _useTranslation=useTranslation(),t=_useTranslation.t;var poolContractAddress=getAddress(contractAddress);var cakeVaultContractAddress=getCakeVaultAddress();var _useBlock=useBlock(),currentBlock=_useBlock.currentBlock;var isXs=breakpoints.isXs,isSm=breakpoints.isSm,isMd=breakpoints.isMd;var showSubtitle=(isXs||isSm)&&sousId===0;var _getPoolBlockInfo=getPoolBlockInfo(pool,currentBlock),shouldShowBlockCountdown=_getPoolBlockInfo.shouldShowBlockCountdown,blocksUntilStart=_getPoolBlockInfo.blocksUntilStart,blocksRemaining=_getPoolBlockInfo.blocksRemaining,hasPoolStarted=_getPoolBlockInfo.hasPoolStarted,blocksToDisplay=_getPoolBlockInfo.blocksToDisplay;var isMetaMaskInScope=!!((_window$ethereum=window.ethereum)===null||_window$ethereum===void 0?void 0:_window$ethereum.isMetaMask);var tokenAddress=earningToken.address?getAddress(earningToken.address):'';var imageSrc=\"\".concat(BASE_URL,\"/images/tokens/\").concat(tokenAddress,\".png\");var _useCakeVault=useCakeVault(),totalCakeInVault=_useCakeVault.totalCakeInVault,performanceFee=_useCakeVault.fees.performanceFee;var performanceFeeAsDecimal=performanceFee&&performanceFee/100;var isManualCakePool=sousId===0;var getTotalStakedBalance=function getTotalStakedBalance(){if(isAutoVault){return getBalanceNumber(totalCakeInVault,stakingToken.decimals);}if(isManualCakePool){var manualCakeTotalMinusAutoVault=new BigNumber(totalStaked).minus(totalCakeInVault);return getBalanceNumber(manualCakeTotalMinusAutoVault,stakingToken.decimals);}return getBalanceNumber(totalStaked,stakingToken.decimals);};var _useTooltip=useTooltip(t('Total amount of %symbol% staked in this pool',{symbol:stakingToken.symbol}),{placement:'bottom'}),totalStakedTargetRef=_useTooltip.targetRef,totalStakedTooltip=_useTooltip.tooltip,totalStakedTooltipVisible=_useTooltip.tooltipVisible;var manualTooltipText=t('You must harvest and compound your earnings from this pool manually.');var autoTooltipText=t('Any funds you stake in this pool will be automagically harvested and restaked (compounded) for you.');var _useTooltip2=useTooltip(isAutoVault?autoTooltipText:manualTooltipText,{placement:'bottom-start'}),tagTargetRef=_useTooltip2.targetRef,tagTooltip=_useTooltip2.tooltip,tagTooltipVisible=_useTooltip2.tooltipVisible;var maxStakeRow=stakingLimit.gt(0)?/*#__PURE__*/_jsxs(Flex,{mb:\"8px\",justifyContent:\"space-between\",children:[/*#__PURE__*/_jsxs(Text,{children:[t('Max. stake per user'),\":\"]}),/*#__PURE__*/_jsx(Text,{children:\"\".concat(getFullDisplayBalance(stakingLimit,stakingToken.decimals,0),\" \").concat(stakingToken.symbol)})]}):null;var blocksRow=blocksRemaining||blocksUntilStart?/*#__PURE__*/_jsxs(Flex,{mb:\"8px\",justifyContent:\"space-between\",children:[/*#__PURE__*/_jsxs(Text,{children:[hasPoolStarted?t('Ends in'):t('Starts in'),\":\"]}),/*#__PURE__*/_jsx(Flex,{children:/*#__PURE__*/_jsxs(Link,{external:true,href:getBscScanBlockCountdownUrl(hasPoolStarted?endBlock:startBlock),children:[/*#__PURE__*/_jsx(Balance,{fontSize:\"16px\",value:blocksToDisplay,decimals:0,color:\"primary\"}),/*#__PURE__*/_jsx(Text,{ml:\"4px\",color:\"primary\",textTransform:\"lowercase\",children:t('Blocks')}),/*#__PURE__*/_jsx(TimerIcon,{ml:\"4px\",color:\"primary\"})]})})]}):/*#__PURE__*/_jsx(Skeleton,{width:\"56px\",height:\"16px\"});var aprRow=/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",alignItems:\"center\",mb:\"8px\",children:[/*#__PURE__*/_jsxs(Text,{children:[isAutoVault?t('APY'):t('APR'),\":\"]}),/*#__PURE__*/_jsx(Apr,{pool:pool,showIcon:true,performanceFee:isAutoVault?performanceFeeAsDecimal:0})]});var totalStakedRow=/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",alignItems:\"center\",mb:\"8px\",children:[/*#__PURE__*/_jsxs(Text,{maxWidth:['50px','100%'],children:[t('Total staked'),\":\"]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",children:[totalStaked&&totalStaked.gte(0)?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Balance,{fontSize:\"16px\",value:getTotalStakedBalance(),decimals:0,unit:\" \".concat(stakingToken.symbol)}),/*#__PURE__*/_jsx(\"span\",{ref:totalStakedTargetRef,children:/*#__PURE__*/_jsx(HelpIcon,{color:\"textSubtle\",width:\"20px\",ml:\"4px\"})})]}):/*#__PURE__*/_jsx(Skeleton,{width:\"56px\",height:\"16px\"}),totalStakedTooltipVisible&&totalStakedTooltip]})]});return/*#__PURE__*/_jsxs(StyledActionPanel,{expanded:expanded,children:[/*#__PURE__*/_jsxs(InfoSection,{children:[maxStakeRow,(isXs||isSm)&&aprRow,(isXs||isSm||isMd)&&totalStakedRow,shouldShowBlockCountdown&&blocksRow,/*#__PURE__*/_jsx(Flex,{mb:\"8px\",justifyContent:['flex-end','flex-end','flex-start'],children:/*#__PURE__*/_jsx(LinkExternal,{href:\"https://pancakeswap.info/token/\".concat(getAddress(earningToken.address)),bold:false,children:t('See Token Info')})}),/*#__PURE__*/_jsx(Flex,{mb:\"8px\",justifyContent:['flex-end','flex-end','flex-start'],children:/*#__PURE__*/_jsx(LinkExternal,{href:earningToken.projectLink,bold:false,children:t('View Project Site')})}),poolContractAddress&&/*#__PURE__*/_jsx(Flex,{mb:\"8px\",justifyContent:['flex-end','flex-end','flex-start'],children:/*#__PURE__*/_jsx(LinkExternal,{href:\"\".concat(BASE_BSC_SCAN_URL,\"/address/\").concat(isAutoVault?cakeVaultContractAddress:poolContractAddress),bold:false,children:t('View Contract')})}),account&&isMetaMaskInScope&&tokenAddress&&/*#__PURE__*/_jsx(Flex,{mb:\"8px\",justifyContent:['flex-end','flex-end','flex-start'],children:/*#__PURE__*/_jsxs(Button,{variant:\"text\",p:\"0\",height:\"auto\",onClick:function onClick(){return registerToken(tokenAddress,earningToken.symbol,earningToken.decimals,imageSrc);},children:[/*#__PURE__*/_jsx(Text,{color:\"primary\",children:t('Add to Metamask')}),/*#__PURE__*/_jsx(MetamaskIcon,{ml:\"4px\"})]})}),isAutoVault?/*#__PURE__*/_jsx(CompoundingPoolTag,{}):/*#__PURE__*/_jsx(ManualPoolTag,{}),tagTooltipVisible&&tagTooltip,/*#__PURE__*/_jsx(\"span\",{ref:tagTargetRef,children:/*#__PURE__*/_jsx(HelpIcon,{ml:\"4px\",width:\"20px\",height:\"20px\",color:\"textSubtle\"})})]}),/*#__PURE__*/_jsxs(ActionContainer,{children:[showSubtitle&&/*#__PURE__*/_jsx(Text,{mt:\"4px\",mb:\"16px\",color:\"textSubtle\",children:isAutoVault?t('Automatic restaking'):\"\".concat(t('Earn'),\" CAKE \").concat(t('Stake').toLocaleLowerCase(),\" CAKE\")}),/*#__PURE__*/_jsx(Harvest,_objectSpread(_objectSpread({},pool),{},{userDataLoaded:userDataLoaded})),/*#__PURE__*/_jsx(Stake,{pool:pool,userDataLoaded:userDataLoaded})]})]});};export default ActionPanel;","map":{"version":3,"sources":["/home/kodachi/Desktop/Frontend1/Frontend1/src/views/Pools/components/PoolsTable/ActionPanel/ActionPanel.tsx"],"names":["React","styled","keyframes","css","Box","Button","Flex","HelpIcon","Link","LinkExternal","MetamaskIcon","Skeleton","Text","TimerIcon","useTooltip","BASE_BSC_SCAN_URL","BASE_URL","getBscScanBlockCountdownUrl","useBlock","useCakeVault","BigNumber","useTranslation","Balance","CompoundingPoolTag","ManualPoolTag","getAddress","getCakeVaultAddress","registerToken","getBalanceNumber","getFullDisplayBalance","getPoolBlockInfo","Harvest","Stake","Apr","expandAnimation","collapseAnimation","StyledActionPanel","div","expanded","theme","colors","dropdown","mediaQueries","lg","ActionContainer","sm","InfoSection","ActionPanel","account","pool","userDataLoaded","breakpoints","sousId","stakingToken","earningToken","totalStaked","startBlock","endBlock","stakingLimit","contractAddress","isAutoVault","t","poolContractAddress","cakeVaultContractAddress","currentBlock","isXs","isSm","isMd","showSubtitle","shouldShowBlockCountdown","blocksUntilStart","blocksRemaining","hasPoolStarted","blocksToDisplay","isMetaMaskInScope","window","ethereum","isMetaMask","tokenAddress","address","imageSrc","totalCakeInVault","performanceFee","fees","performanceFeeAsDecimal","isManualCakePool","getTotalStakedBalance","decimals","manualCakeTotalMinusAutoVault","minus","symbol","placement","totalStakedTargetRef","targetRef","totalStakedTooltip","tooltip","totalStakedTooltipVisible","tooltipVisible","manualTooltipText","autoTooltipText","tagTargetRef","tagTooltip","tagTooltipVisible","maxStakeRow","gt","blocksRow","aprRow","totalStakedRow","gte","projectLink","toLocaleLowerCase"],"mappings":"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","sourcesContent":["import React from 'react'\nimport styled, { keyframes, css } from 'styled-components'\nimport {\n  Box,\n  Button,\n  Flex,\n  HelpIcon,\n  Link,\n  LinkExternal,\n  MetamaskIcon,\n  Skeleton,\n  Text,\n  TimerIcon,\n  useTooltip,\n} from '@pancakeswap/uikit'\nimport { BASE_BSC_SCAN_URL, BASE_URL } from 'config'\nimport { getBscScanBlockCountdownUrl } from 'utils/bscscan'\nimport { useBlock, useCakeVault } from 'state/hooks'\nimport BigNumber from 'bignumber.js'\nimport { Pool } from 'state/types'\nimport { useTranslation } from 'contexts/Localization'\nimport Balance from 'components/Balance'\nimport { CompoundingPoolTag, ManualPoolTag } from 'components/Tags'\nimport { getAddress, getCakeVaultAddress } from 'utils/addressHelpers'\nimport { registerToken } from 'utils/wallet'\nimport { getBalanceNumber, getFullDisplayBalance } from 'utils/formatBalance'\nimport { getPoolBlockInfo } from 'views/Pools/helpers'\nimport Harvest from './Harvest'\nimport Stake from './Stake'\nimport Apr from '../Apr'\n\nconst expandAnimation = keyframes`\n  from {\n    max-height: 0px;\n  }\n  to {\n    max-height: 700px;\n  }\n`\n\nconst collapseAnimation = keyframes`\n  from {\n    max-height: 700px;\n  }\n  to {\n    max-height: 0px;\n  }\n`\n\nconst StyledActionPanel = styled.div<{ expanded: boolean }>`\n  animation: ${({ expanded }) =>\n    expanded\n      ? css`\n          ${expandAnimation} 300ms linear forwards\n        `\n      : css`\n          ${collapseAnimation} 300ms linear forwards\n        `};\n  overflow: hidden;\n  background: ${({ theme }) => theme.colors.dropdown};\n  display: flex;\n  flex-direction: column-reverse;\n  justify-content: center;\n  padding: 12px;\n\n  ${({ theme }) => theme.mediaQueries.lg} {\n    flex-direction: row;\n    padding: 16px 32px;\n  }\n`\n\nconst ActionContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  ${({ theme }) => theme.mediaQueries.sm} {\n    flex-direction: row;\n    align-items: center;\n    flex-grow: 1;\n    flex-basis: 0;\n  }\n`\n\ntype MediaBreakpoints = {\n  isXs: boolean\n  isSm: boolean\n  isMd: boolean\n  isLg: boolean\n  isXl: boolean\n}\n\ninterface ActionPanelProps {\n  account: string\n  pool: Pool\n  userDataLoaded: boolean\n  expanded: boolean\n  breakpoints: MediaBreakpoints\n}\n\nconst InfoSection = styled(Box)`\n  flex-grow: 0;\n  flex-shrink: 0;\n  flex-basis: auto;\n  padding: 8px 8px;\n  ${({ theme }) => theme.mediaQueries.lg} {\n    padding: 0;\n    flex-basis: 230px;\n  }\n`\n\nconst ActionPanel: React.FC<ActionPanelProps> = ({ account, pool, userDataLoaded, expanded, breakpoints }) => {\n  const {\n    sousId,\n    stakingToken,\n    earningToken,\n    totalStaked,\n    startBlock,\n    endBlock,\n    stakingLimit,\n    contractAddress,\n    isAutoVault,\n  } = pool\n  const { t } = useTranslation()\n  const poolContractAddress = getAddress(contractAddress)\n  const cakeVaultContractAddress = getCakeVaultAddress()\n  const { currentBlock } = useBlock()\n  const { isXs, isSm, isMd } = breakpoints\n  const showSubtitle = (isXs || isSm) && sousId === 0\n\n  const { shouldShowBlockCountdown, blocksUntilStart, blocksRemaining, hasPoolStarted, blocksToDisplay } =\n    getPoolBlockInfo(pool, currentBlock)\n\n  const isMetaMaskInScope = !!window.ethereum?.isMetaMask\n  const tokenAddress = earningToken.address ? getAddress(earningToken.address) : ''\n  const imageSrc = `${BASE_URL}/images/tokens/${tokenAddress}.png`\n\n  const {\n    totalCakeInVault,\n    fees: { performanceFee },\n  } = useCakeVault()\n\n  const performanceFeeAsDecimal = performanceFee && performanceFee / 100\n  const isManualCakePool = sousId === 0\n\n  const getTotalStakedBalance = () => {\n    if (isAutoVault) {\n      return getBalanceNumber(totalCakeInVault, stakingToken.decimals)\n    }\n    if (isManualCakePool) {\n      const manualCakeTotalMinusAutoVault = new BigNumber(totalStaked).minus(totalCakeInVault)\n      return getBalanceNumber(manualCakeTotalMinusAutoVault, stakingToken.decimals)\n    }\n    return getBalanceNumber(totalStaked, stakingToken.decimals)\n  }\n\n  const {\n    targetRef: totalStakedTargetRef,\n    tooltip: totalStakedTooltip,\n    tooltipVisible: totalStakedTooltipVisible,\n  } = useTooltip(t('Total amount of %symbol% staked in this pool', { symbol: stakingToken.symbol }), {\n    placement: 'bottom',\n  })\n\n  const manualTooltipText = t('You must harvest and compound your earnings from this pool manually.')\n  const autoTooltipText = t(\n    'Any funds you stake in this pool will be automagically harvested and restaked (compounded) for you.',\n  )\n\n  const {\n    targetRef: tagTargetRef,\n    tooltip: tagTooltip,\n    tooltipVisible: tagTooltipVisible,\n  } = useTooltip(isAutoVault ? autoTooltipText : manualTooltipText, {\n    placement: 'bottom-start',\n  })\n\n  const maxStakeRow = stakingLimit.gt(0) ? (\n    <Flex mb=\"8px\" justifyContent=\"space-between\">\n      <Text>{t('Max. stake per user')}:</Text>\n      <Text>{`${getFullDisplayBalance(stakingLimit, stakingToken.decimals, 0)} ${stakingToken.symbol}`}</Text>\n    </Flex>\n  ) : null\n\n  const blocksRow =\n    blocksRemaining || blocksUntilStart ? (\n      <Flex mb=\"8px\" justifyContent=\"space-between\">\n        <Text>{hasPoolStarted ? t('Ends in') : t('Starts in')}:</Text>\n        <Flex>\n          <Link external href={getBscScanBlockCountdownUrl(hasPoolStarted ? endBlock : startBlock)}>\n            <Balance fontSize=\"16px\" value={blocksToDisplay} decimals={0} color=\"primary\" />\n            <Text ml=\"4px\" color=\"primary\" textTransform=\"lowercase\">\n              {t('Blocks')}\n            </Text>\n            <TimerIcon ml=\"4px\" color=\"primary\" />\n          </Link>\n        </Flex>\n      </Flex>\n    ) : (\n      <Skeleton width=\"56px\" height=\"16px\" />\n    )\n\n  const aprRow = (\n    <Flex justifyContent=\"space-between\" alignItems=\"center\" mb=\"8px\">\n      <Text>{isAutoVault ? t('APY') : t('APR')}:</Text>\n      <Apr pool={pool} showIcon performanceFee={isAutoVault ? performanceFeeAsDecimal : 0} />\n    </Flex>\n  )\n\n  const totalStakedRow = (\n    <Flex justifyContent=\"space-between\" alignItems=\"center\" mb=\"8px\">\n      <Text maxWidth={['50px', '100%']}>{t('Total staked')}:</Text>\n      <Flex alignItems=\"center\">\n        {totalStaked && totalStaked.gte(0) ? (\n          <>\n            <Balance fontSize=\"16px\" value={getTotalStakedBalance()} decimals={0} unit={` ${stakingToken.symbol}`} />\n            <span ref={totalStakedTargetRef}>\n              <HelpIcon color=\"textSubtle\" width=\"20px\" ml=\"4px\" />\n            </span>\n          </>\n        ) : (\n          <Skeleton width=\"56px\" height=\"16px\" />\n        )}\n        {totalStakedTooltipVisible && totalStakedTooltip}\n      </Flex>\n    </Flex>\n  )\n\n  return (\n    <StyledActionPanel expanded={expanded}>\n      <InfoSection>\n        {maxStakeRow}\n        {(isXs || isSm) && aprRow}\n        {(isXs || isSm || isMd) && totalStakedRow}\n        {shouldShowBlockCountdown && blocksRow}\n        <Flex mb=\"8px\" justifyContent={['flex-end', 'flex-end', 'flex-start']}>\n          <LinkExternal href={`https://pancakeswap.info/token/${getAddress(earningToken.address)}`} bold={false}>\n            {t('See Token Info')}\n          </LinkExternal>\n        </Flex>\n        <Flex mb=\"8px\" justifyContent={['flex-end', 'flex-end', 'flex-start']}>\n          <LinkExternal href={earningToken.projectLink} bold={false}>\n            {t('View Project Site')}\n          </LinkExternal>\n        </Flex>\n        {poolContractAddress && (\n          <Flex mb=\"8px\" justifyContent={['flex-end', 'flex-end', 'flex-start']}>\n            <LinkExternal\n              href={`${BASE_BSC_SCAN_URL}/address/${isAutoVault ? cakeVaultContractAddress : poolContractAddress}`}\n              bold={false}\n            >\n              {t('View Contract')}\n            </LinkExternal>\n          </Flex>\n        )}\n        {account && isMetaMaskInScope && tokenAddress && (\n          <Flex mb=\"8px\" justifyContent={['flex-end', 'flex-end', 'flex-start']}>\n            <Button\n              variant=\"text\"\n              p=\"0\"\n              height=\"auto\"\n              onClick={() => registerToken(tokenAddress, earningToken.symbol, earningToken.decimals, imageSrc)}\n            >\n              <Text color=\"primary\">{t('Add to Metamask')}</Text>\n              <MetamaskIcon ml=\"4px\" />\n            </Button>\n          </Flex>\n        )}\n        {isAutoVault ? <CompoundingPoolTag /> : <ManualPoolTag />}\n        {tagTooltipVisible && tagTooltip}\n        <span ref={tagTargetRef}>\n          <HelpIcon ml=\"4px\" width=\"20px\" height=\"20px\" color=\"textSubtle\" />\n        </span>\n      </InfoSection>\n      <ActionContainer>\n        {showSubtitle && (\n          <Text mt=\"4px\" mb=\"16px\" color=\"textSubtle\">\n            {isAutoVault ? t('Automatic restaking') : `${t('Earn')} CAKE ${t('Stake').toLocaleLowerCase()} CAKE`}\n          </Text>\n        )}\n        <Harvest {...pool} userDataLoaded={userDataLoaded} />\n        <Stake pool={pool} userDataLoaded={userDataLoaded} />\n      </ActionContainer>\n    </StyledActionPanel>\n  )\n}\n\nexport default ActionPanel\n"]},"metadata":{},"sourceType":"module"}